{
    "author": "Lukas Reiter", 
    "plugins": [
        4
    ], 
    "uuid": "cd9f9437-da1d-41b9-9660-4e3575268f62", 
    "version": "v1.0", 
    "script": "\"\"\"\nThis script\na) silently drops HTTP requests to hosts that are specified in list session[\"filter\"] or\nb) silently forwards (without proxy interception) HTTP requests to hosts that are specified in list session[\"ignore\"]\nand which were issued by Burp Suite Proxy tool (IBurpExtenderCallbacks.TOOL_PROXY).\n\"\"\"\nimport re\nfrom burp import IInterceptedProxyMessage\nfrom burp import IBurpExtenderCallbacks\n# Do the initial setup\nif ref == 1 or \"filter\" not in session or \"ignore\" not in session:\n\tsession[\"filter\"] = [re.compile(\"^.+\\.mozilla\\.((com)|(org)|(net))$\", re.IGNORECASE),\n\t\t\t\t\t\t\t\t\t\t\tre.compile(\"^.+\\.firefox\\.((com)|(org)|(net))$\", re.IGNORECASE),\n\t\t\t\t\t\t\t\t\t\t\tre.compile(\"^.+\\.google\\.((com)|(org)|(net))$\", re.IGNORECASE),\n\t\t\t\t\t\t\t\t\t\t\tre.compile(\"^.+\\.google-analytics\\.((com)|(org)|(net))$\", re.IGNORECASE),\n\t\t\t\t\t\t\t\t\t\t\tre.compile(\"^.+\\.yahoo\\.((com)|(org)|(net))$\", re.IGNORECASE),\n\t\t\t\t\t\t\t\t\t\t\tre.compile(\"^.+\\.goo\\.gl$\", re.IGNORECASE),\n\t\t\t\t\t\t\t\t\t\t\tre.compile(\"^.+\\.googleapis\\.((com)|(org)|(net))$\", re.IGNORECASE),\n\t\t\t\t\t\t\t\t\t\t\tre.compile(\"^.+\\.gstatic\\.((com)|(org)|(net))$\", re.IGNORECASE),\n\t\t\t\t\t\t\t\t\t\t\tre.compile(\"^ciscobinary\\.openh264\\.org$\", re.IGNORECASE),\n\t\t\t\t\t\t\t\t\t\t\tre.compile(\"^ocsp\\.apple\\.com$\", re.IGNORECASE)]\n\tsession[\"ignore\"] = []\n# Process each HTTP request issued by the Burp Suite Proxy tool\nif is_request and plugin_id == IBurpExtenderCallbacks.TOOL_PROXY:\n\thost = url.getHost()\n\tfor filter in session[\"filter\"]:\n\t\tif filter.match(host):\n\t\t\tprint(\"Dropping host: {}\".format(host))\n\t\t\tproxy_message_info.setInterceptAction(IInterceptedProxyMessage.ACTION_DROP)\n\tfor filter in session[\"ignore\"]:\n\t\turl_str = unicode(url)\n\t\tif filter.match(url_str):\n\t\t\tprint(\"Ignoring url: {}\". format(url_str))\n\t\t\tproxy_message_info.setInterceptAction(IInterceptedProxyMessage.ACTION_DONT_INTERCEPT)\n", 
    "name": "Template Script to Silently Drop Unwanted Communication"
}